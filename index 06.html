<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculateur de Date Avancé (Mobile)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* CSS pour l'aspect mobile et le centrage */
        body {
            /* Propriétés de fond de l'image */
            background-image: url('TA.jpg'); 
            background-size: cover; 
            background-attachment: fixed;
            background-repeat: no-repeat;
            background-color: #f0f4f8; 

            /* Propriétés pour le centrage horizontal et vertical */
            font-family: Arial, sans-serif;
            min-height: 100vh;
            display: flex; 
            justify-content: center; 
            align-items: center; 
            padding: 20px;
            margin: 0;
            position: relative;
        }
        
        /* Conteneur de l'application (simule l'écran) */
        .app-container {
            max-width: 450px; 
            width: 100%; 
            background-color: #ffffff; 
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3); 
            border-radius: 12px; 
            overflow: hidden; 
            position: relative;
        }
        .header {
            background-color: #4c51bf;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 10px; 
        }
        .app-icon {
            margin-bottom: 15px;
            border-radius: 50%; 
            border: 4px solid white;
        }

        /* DÉFINITION DE L'ANIMATION CLIGNOTANTE */
        @keyframes blinker {
            50% { opacity: 0.2; }
        }
        
        /* CLASSE GÉNÉRIQUE DE CLIGNOTEMENT */
        .clignotant {
            animation: blinker 1s linear infinite;
            font-weight: bold;
        }

        /* COULEURS DE BASE */
        /* Grégorien de base: Orange */
        .text-base-grego {
            color: #f97316 !important; /* Orange non clignotant */
        }
        /* Lunaire de base: Vert */
        .text-base-lunaire {
            color: #10b981 !important; /* Vert émeraude non clignotant */
        }

        .ferie-info {
            display: block;
            font-size: 0.8rem;
            font-weight: 600;
            color: #e53e3e; /* Rouge pour l'alerte */
        }
        
        /* STYLE DU GUIDE ET DU COMPTEUR */
        .footer-content {
            background-color: #f7f7f7;
            padding: 15px;
            border-top: 1px solid #e0e0e0;
            font-size: 0.8rem;
        }
        .footer-content h3 {
            font-weight: bold;
            color: #4c51bf;
            margin-bottom: 5px;
        }

        /* STYLE DU COMPTEUR DE VISITEURS */
        #compteur-visiteurs {
            display: block;
            text-align: right;
            color: #9ca3af;
            font-size: 0.65rem;
            margin-top: 5px;
        }
        
        /* Styles pour la légende dans le guide */
        .legende-item {
            margin-bottom: 3px;
        }
        .legende-couleur {
            display: inline-block;
            width: 10px;
            height: 10px;
            margin-right: 5px;
            border-radius: 50%;
        }
    </style>
</head>
<body>

<div class="app-container">
    <header class="header p-4 shadow-md">
        <img src="TA.jpg" alt="Icône principale" class="app-icon w-16 h-16"> 
        
        <h1 class="text-xl font-bold mb-3">Calculateur de Date Avancé</h1>
    </header>

    <main class="p-6">
        <div class="mb-6 p-4 bg-gray-100 rounded-lg border-l-4 border-indigo-500">
            <div class="flex items-center mb-2">
                <img src="TA.jpg" alt="Icône calendrier" class="w-5 h-5 mr-2"> 
                <label class="text-sm font-medium text-gray-700">Date d'aujourd'hui (Grégorien)</label>
            </div>
            <p id="date-aujourdhui" class="text-lg font-semibold text-indigo-700"></p>
        </div>

        <div class="mb-8">
            <label for="jours-a-ajouter" class="block text-sm font-medium text-gray-700 mb-2">
                Nombre de jours à ajouter/soustraire (ex: 5 ou -10)
            </label>
            <input type="number" id="jours-a-ajouter" value="28"
                   class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 text-center text-xl shadow-sm"
                   placeholder="Entrez un nombre de jours">
        </div>

        <button onclick="calculerDate()"
                class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 rounded-lg shadow-md transition duration-150 ease-in-out transform hover:scale-105">
            Calculer la Nouvelle Date (Automatique)
        </button>

        <div id="resultats-section" class="mt-8 p-5 border border-gray-200 rounded-lg hidden">
            <h2 class="text-lg font-bold text-gray-800 mb-3 border-b pb-2">Nouvelle Date Calculée</h2>

            <div class="mb-4">
                <div class="flex items-center">
                    <img src="TA.jpg" alt="Icône Grégorien" class="w-4 h-4 mr-2">
                    <label class="text-sm font-medium text-gray-600">Calendrier Grégorien</label>
                </div>
                <p id="date-grego" class="text-xl font-extrabold text-base-grego mt-1"></p> 
                <span id="ferie-gregorian-name" class="ferie-info hidden"></span>
            </div>

            <div>
                <div class="flex items-center">
                    <img src="TA.jpg" alt="Icône Lunaire" class="w-4 h-4 mr-2"> 
                    <label class="text-sm font-medium text-gray-600">Calendrier Lunaire (Hijri)</label>
                </div>
                <p id="date-lunaire" class="text-xl font-extrabold text-base-lunaire mt-1"></p>
                <span id="ferie-hijri-name" class="ferie-info hidden"></span>
            </div>
        </div>

        <div id="erreur-message" class="mt-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded hidden">
            Veuillez entrer un nombre valide de jours.
        </div>
    </main>
    
    <footer class="footer-content">
        <h3>Guide d'Utilisation et Légende des Styles</h3>
        <p class="mb-2">Le style clignotant est l'indicateur d'un événement spécial. **Jour férié ou Week-end**.</p>
        
        <div class="legende-item mt-3">
            <span class="legende-couleur" style="background-color: #f97316;"></span>
            <span style="font-weight: bold; color: #f97316;">Texte Orange</span> : Date Grégorienne (Couleur de base).
        </div>
        <div class="legende-item">
            <span class="legende-couleur" style="background-color: #10b981;"></span>
            <span style="font-weight: bold; color: #10b981;">Texte Vert</span> : Date Lunaire (Hijri) (Couleur de base).
        </div>
        
        <p id="compteur-visiteurs"></p>
    </footer>
    
</div>

<script>
    // --- LISTE DES JOURS FÉRIÉS ALGÉRIENS (MISE À JOUR 2025) ---
    const joursFeries = [
        // Jours fériés civils (GREGORIAN)
        { month: 0, day: 1, name: "Jour de l'An", type: 'GREGORIAN' },
        { month: 0, day: 12, name: "Yennayer (Nouvel An Berbère)", type: 'GREGORIAN' },
        { month: 4, day: 1, name: "Fête du Travail", type: 'GREGORIAN' },
        { month: 6, day: 5, name: "Fête de l'Indépendance", type: 'GREGORIAN' },
        { month: 9, day: 1, name: "Fête de la Révolution", type: 'GREGORIAN' }, 
        
        // Jours fériés religieux (HIJRI - dates Grégoriennes prévues pour 2025)
        { month: 2, day: 31, name: "Aïd el-Fitr (1er jour)", type: 'HIJRI' },
        { month: 3, day: 1, name: "Aïd el-Fitr (2ème jour)", type: 'HIJRI' },
        { month: 3, day: 2, name: "Aïd el-Fitr (3ème jour)", type: 'HIJRI' },
        
        { month: 5, day: 6, name: "Aïd el-Adha (1er jour)", type: 'HIJRI' },
        { month: 5, day: 7, name: "Aïd el-Adha (2ème jour)", type: 'HIJRI' },
        { month: 5, day: 8, name: "Aïd el-Adha (3ème jour)", type: 'HIJRI' },

        { month: 5, day: 27, name: "Awal Mouharram (Nouvel An Hégirien)", type: 'HIJRI' },
        { month: 6, day: 5, name: "Achoura", type: 'HIJRI' },
        { month: 8, day: 4, name: "Mouloud (Mawlid Ennabaoui)", type: 'HIJRI' }
    ];

    function getSpecificHolidayInfo(date) {
        const day = date.getDate();
        const month = date.getMonth(); 
        const ferieMatch = joursFeries.find(ferie => {
            return ferie.day === day && ferie.month === month;
        });
        return ferieMatch || null;
    }

    function isWeekend(date) {
        const dayOfWeek = date.getDay(); // 5=Vendredi, 6=Samedi
        if (dayOfWeek === 5) return { name: "Jour de repos (Vendredi)", type: 'WEEKEND' };
        if (dayOfWeek === 6) return { name: "Jour de repos (Samedi)", type: 'WEEKEND' };
        return null;
    }

    // --- FONCTION DE GESTION DU COMPTEUR DE VISITEURS ---
    function gererCompteurVisiteurs() {
        let compteur = localStorage.getItem('visitesCompteur');
        
        if (compteur === null) {
            compteur = 1;
        } else {
            compteur = parseInt(compteur) + 1;
        }
        localStorage.setItem('visitesCompteur', compteur);
        document.getElementById('compteur-visiteurs').textContent = `Visites : ${compteur}`;
    }

    // --- FONCTION PRINCIPALE DE CALCUL ET D'AFFICHAGE ---
    function calculerDate() {
        const inputElement = document.getElementById('jours-a-ajouter');
        const joursAAjouter = parseInt(inputElement.value);
        const resultatsSection = document.getElementById('resultats-section');
        const erreurMessage = document.getElementById('erreur-message');
        
        const dateGregoElement = document.getElementById('date-grego');
        const dateLunaireElement = document.getElementById('date-lunaire');
        const ferieGregoNameElement = document.getElementById('ferie-gregorian-name');
        const ferieHijriNameElement = document.getElementById('ferie-hijri-name');

        // 0. Réinitialisation des styles et couleurs
        const elementsToClear = [dateGregoElement, dateLunaireElement];
        const classesToClear = ['clignotant', 'text-base-grego', 'text-base-lunaire', 'text-green-600', 'text-red-600'];
        elementsToClear.forEach(el => {
            el.classList.remove(...classesToClear);
            el.style.fontWeight = ''; // Réinitialiser le gras
        });
        ferieGregoNameElement.classList.add('hidden');
        ferieHijriNameElement.classList.add('hidden');
        
        // Applique les nouvelles couleurs de base (Orange pour Grégorien, Vert pour Lunaire)
        dateGregoElement.classList.add('text-base-grego');
        dateLunaireElement.classList.add('text-base-lunaire');


        if (inputElement.value === '' || isNaN(joursAAjouter)) {
            erreurMessage.classList.remove('hidden');
            resultatsSection.classList.add('hidden');
            return;
        }
        erreurMessage.classList.add('hidden');

        // 1. Calcul de la nouvelle date
        const dateActuelle = new Date();
        const nouvelleDate = new Date(dateActuelle.getTime());
        nouvelleDate.setDate(dateActuelle.getDate() + joursAAjouter);

        // 2. Vérification des conditions
        const weekendInfo = isWeekend(nouvelleDate);
        const holidayInfo = getSpecificHolidayInfo(nouvelleDate);
        let finalFerieName = null;
        
        
        // --- LOGIQUE DE CONTRÔLE SÉPARÉE ---
        
        let isClignotantGrego = false;
        let isClignotantLunaire = false;

        // **PRIORITÉ 1 : Week-end** (Clignotement sur les deux dates)
        if (weekendInfo) {
            finalFerieName = weekendInfo.name;
            isClignotantGrego = true;
            isClignotantLunaire = true;
        }

        // **PRIORITÉ 2 : Jours Fériés Spécifiques** (Surchargent le nom et le clignotement)
        
        if (holidayInfo) {
            finalFerieName = holidayInfo.name; // Le nom du jour férié spécifique est prioritaire

            // a) Jour Férié Grégorien : SEULE la Grégorienne clignote
            if (holidayInfo.type === 'GREGORIAN') {
                isClignotantGrego = true;
                // Si la date est aussi un week-end, la Lunaire clignote toujours à cause du weekendInfo (ci-dessus)
                // MAIS si ce n'est PAS un week-end, la Lunaire ne clignotera pas.
            }
            
            // b) Jour Férié Lunaire : SEULE la Lunaire clignote
            if (holidayInfo.type === 'HIJRI') {
                isClignotantLunaire = true;
                // La Grégorienne NE clignote PAS (sauf si c'est déjà un week-end)
            }
        }
        
        
        // **3. Application du style Clignotant final**
        // Si le clignotement est requis par l'une des conditions ci-dessus :
        if (isClignotantGrego) {
            dateGregoElement.classList.add('clignotant');
        } else {
            // Si la condition de jour férié grégorien N'EST PAS remplie, on s'assure que le clignotement est retiré
            // MAIS on le réapplique si c'est un week-end (logique du weekendInfo est prioritaire)
             if (weekendInfo) {
                dateGregoElement.classList.add('clignotant');
             }
        }

        if (isClignotantLunaire) {
            dateLunaireElement.classList.add('clignotant');
        } else {
            // Même logique pour le Lunaire
             if (weekendInfo) {
                dateLunaireElement.classList.add('clignotant');
             }
        }
        // NOTE: La logique ci-dessus est complexe pour gérer les chevauchements. 
        // L'implémentation précédente utilisant isClignotantGrego = true et isClignotantLunaire = true 
        // était en fait suffisante et plus propre, car le jour férié surcharge le nom mais pas la condition de clignotement du week-end. 
        // Je reviens donc à la version de la PRÉCÉDENTE réponse mais je m'assure que la logique Grégorienne/Lunaire est bien indépendante 
        // SAUF pour le week-end, comme vous le souhaitez.

        // --- NOUVELLE LOGIQUE DE CLIGNOTEMENT REVISITÉE POUR UNE MEILLEURE GESTION ---
        isClignotantGrego = false;
        isClignotantLunaire = false;
        finalFerieName = null;

        // 1. Déterminer le nom (Jour Férié a la priorité sur Week-end)
        if (holidayInfo) {
             finalFerieName = holidayInfo.name;
        } else if (weekendInfo) {
             finalFerieName = weekendInfo.name;
        }
        
        // 2. Déterminer le clignotement (chaque calendrier est évalué indépendamment)
        
        // Clignotement Grégorien si : Week-end OU Jour Férié Grégorien
        if (weekendInfo || (holidayInfo && holidayInfo.type === 'GREGORIAN')) {
            isClignotantGrego = true;
        }
        
        // Clignotement Lunaire si : Week-end OU Jour Férié Lunaire
        if (weekendInfo || (holidayInfo && holidayInfo.type === 'HIJRI')) {
            isClignotantLunaire = true;
        }
        
        // 3. Application des styles
        if (isClignotantGrego) {
            dateGregoElement.classList.add('clignotant');
        }
        if (isClignotantLunaire) {
            dateLunaireElement.classList.add('clignotant');
        }


        // 4. Affichage du nom du jour férié/week-end
        if (finalFerieName) {
            ferieGregoNameElement.textContent = `🚨 ${finalFerieName}`;
            ferieHijriNameElement.textContent = `🚨 ${finalFerieName}`;
            ferieGregoNameElement.classList.remove('hidden');
            ferieHijriNameElement.classList.remove('hidden');
        }


        // 5. Formatage et affichage des dates
        const optionsGregorian = { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' };
        let dateGregoFormatted = nouvelleDate.toLocaleDateString('fr-FR', optionsGregorian);
        dateGregoFormatted = dateGregoFormatted.charAt(0).toUpperCase() + dateGregoFormatted.slice(1);

        const optionsHijri = { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric', calendar: 'islamic-umalqura' };
        const dateHijriFormatted = nouvelleDate.toLocaleDateString('ar-DZ', optionsHijri);
        const hijriDisplay = dateHijriFormatted.replace(/هـ/g, '').trim();

        dateGregoElement.textContent = dateGregoFormatted;
        dateLunaireElement.textContent = hijriDisplay;
        resultatsSection.classList.remove('hidden');
    }

    // --- INITIALISATION ---
    function initialiserApplication() {
        gererCompteurVisiteurs(); 
        document.getElementById('date-aujourdhui').textContent = new Date().toLocaleDateString('fr-FR', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
        calculerDate(); 
        
        const inputElement = document.getElementById('jours-a-ajouter');
        inputElement.addEventListener('input', calculerDate);
        inputElement.addEventListener('change', calculerDate);
    }

    // Lancement de l'initialisation au chargement de la page
    window.onload = initialiserApplication;
</script>

</body>
</html>